{{#extend "layout-base"}}
	  {{#content "body"}}

      <div class="app" ng-controller="AppCtrl">

          {{#embed "partial-header"}}{{/embed}}
          {{#embed "partial-sidebar"}}{{/embed}}

          <div class="app-pages">
              <div class="app-page hide" data-page="stream" ng-class="{show: page === 'stream' || page == '', hide: page != 'stream' && page != ''}">
                  {{#embed "partial-stream"}}{{/embed}}
              </div>
              <div class="app-page hide"  data-page="account"  ng-class="{show: page === 'account', hide: page != 'account'}">
                  {{#embed "partial-account"}}{{/embed}}
              </div>
              <div class="app-page hide"  data-page="mywallet"  ng-class="{show: page === 'mywallet', hide: page != 'mywallet'}">
                  {{#embed "partial-wallet"}}{{/embed}}
              </div>
              <div class="app-page hide"  data-page="article-assigned"  ng-class="{show: page === 'article-assigned', hide: page != 'article-assigned'}">
                  {{#embed "partial-article-assigned"}}{{/embed}}
              </div>
              <div class="app-page hide"  data-page="article-drafts"  ng-class="{show: page === 'article-drafts', hide: page != 'article-drafts'}">
                  {{#embed "partial-article-drafts"}}{{/embed}}
              </div>
              <div class="app-page hide"  data-page="article-read"  ng-class="{show: page === 'article-read', hide: page != 'article-read'}">
                  {{#embed "partial-article-read"}}{{/embed}}
              </div>
              <div class="app-page hide"  data-page="article-reviewed"  ng-class="{show: page === 'article-reviewed', hide: page != 'article-reviewed'}">
                  {{#embed "partial-article-reviewed"}}{{/embed}}
              </div>
              <div class="app-page hide"  data-page="article-submitted"  ng-class="{show: page === 'article-submitted', hide: page != 'article-submitted'}">
                  {{#embed "partial-article-submitted"}}{{/embed}}
              </div>
              <div class="app-page hide"  data-page="article-editor"  ng-class="{show: page === 'article-editor', hide: page != 'article-editor'}">
                  {{#embed "partial-article-editor"}}{{/embed}}
              </div>
              <div class="app-page hide"  data-page="article-preview"  ng-class="{show: page === 'article-preview', hide: page != 'article-preview'}">
                  {{#embed "partial-article-preview"}}{{/embed}}
              </div>
              <div class="app-page hide"  data-page="article-review"  ng-class="{show: page === 'article-review', hide: page != 'article-review'}">
                  {{#embed "partial-article-review"}}{{/embed}}
              </div>
          </div>

        <script>
          angular.module("DNN")
            .controller("AppCtrl", ["$scope", "$timeout", "$location", function($scope, $timeout, $location) {
                window["addEventListener"]("load", function() {


											let unavailablePopup = function() {
													let popup = new DNN.popup("message","","Thank you for your interest in the DNN demo. We are currently working to update our smart contracts, and will update you as soon as the demo becomes available.",[],"");
													popup.preventHide = true;
													popup.show();
											};

											// Indicates whether or not alpha is in simulated mode
											$scope.isSimulated = false;

											// Current page being viewed
											$scope.page = "stream"

											// Current article being viewed
											$scope.articleHash = "";

											// Sets current page
	                    $scope.setPage = function(page) {
	                        $scope.page = page;
													$location.url(page);
	                    };

											// Loads article for viewing
	                    $scope.viewArticle = function(articleHash) {
	                        $scope.articleHash = articleHash;
													$scope.setPage("article-preview");
											};

											// Loads article for editing
	                    $scope.editArticle = function(articleHash) {
											    $scope.articleHash = articleHash;
													$scope.setPage("article-editor");
	                    };

											// Set current page onload
										  $scope.$on('$locationChangeStart', function(event, next, current) {
													 $scope.page = (($location.url() || "").split("/")[1]) || ""
											});

											// Set current page
											$scope.page = (($location.url() || "").split("/")[1]) || ""

											// Set DNN
											$scope.DNN = DNN;

											// Show loading indicator while we attempt to fetch session user
											LI.show();

											// Attempt to obtain session user
											DNN.Session.get()
												.then(function(user) {
														LI.hide();
														unavailablePopup();
												})
												.catch(function() {
														LI.hide();
														DNN.Redirect("/onboard");
												})

								});
        	}]);
        </script>
		{{/content}}
{{/extend}}
